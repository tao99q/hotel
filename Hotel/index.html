<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>酒店列表</title>
		<link rel="stylesheet" type="text/css" href="css/mui.css" />
		<link rel="stylesheet" type="text/css" href="css/public.css" />
		<link rel="stylesheet" type="text/css" href="font-awesome/css/font-awesome.min.css" />
		<link rel="stylesheet" type="text/css" href="css/index.css" />
		<script src="js/mui.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" charset="utf-8">
			mui.init();
		</script>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title" style="color: #007AFF;">首页</h1>
		</header>
		<div id="refreshContainer" class="mui-content mui-scroll-wrapper">
			<div class="mui-scroll">
				<ul class="mui-table-view">
					<li class="mui-table-view-cell mui-media">
						<img src="img/room1.jpg" class="mui-media-object mui-pull-left hotel-img" />
						<div class="mui-media-body">
							北京钓鱼台国宾馆
							<p class="mui-ellipsis">
								<span class="hotel-rate hotel-color-blue">4.3分</span>
								<i class="fa fa-wifi"></i>
								<span class="hotel-price hotel-color-orange">￥1500</span>
							</p>
							<p class="mui-ellipsis">
								高档酒店
								<i class="fa fa-gift"></i>
							</p>
							<p class="mui-ellipsis">
								公主坟，五棵松，石景山游乐园
								<span class="hotel-away">1公里</span>
							</p>
						</div>
					</li>
					<li class="mui-table-view-cell mui-media">
						<img src="img/room2.jpg" class="mui-media-object mui-pull-left hotel-img" />
						<div class="mui-media-body">
							北京钓鱼台国宾馆
							<p class="mui-ellipsis">
								<span class="hotel-rate hotel-color-blue">4.3分</span>
								<i class="fa fa-wifi"></i>
								<span class="hotel-price hotel-color-orange">￥1500</span>
							</p>
							<p class="mui-ellipsis">
								高档酒店
								<i class="fa fa-gift"></i>
							</p>
							<p class="mui-ellipsis">
								公主坟，五棵松，石景山游乐园
								<span class="hotel-away">1公里</span>
							</p>
						</div>
					</li>
					<li class="mui-table-view-cell mui-media">
						<img src="img/room3.jpg" class="mui-media-object mui-pull-left hotel-img" />
						<div class="mui-media-body">
							北京钓鱼台国宾馆
							<p class="mui-ellipsis">
								<span class="hotel-rate hotel-color-blue">4.3分</span>
								<i class="fa fa-wifi"></i>
								<span class="hotel-price hotel-color-orange">￥1500</span>
							</p>
							<p class="mui-ellipsis">
								高档酒店
								<i class="fa fa-gift"></i>
							</p>
							<p class="mui-ellipsis">
								公主坟，五棵松，石景山游乐园
								<span class="hotel-away">1公里</span>
							</p>
						</div>
					</li>
					<li class="mui-table-view-cell mui-media">
						<img src="img/room4.png" class="mui-media-object mui-pull-left hotel-img" />
						<div class="mui-media-body">
							北京钓鱼台国宾馆
							<p class="mui-ellipsis">
								<span class="hotel-rate hotel-color-blue">4.3分</span>
								<i class="fa fa-wifi"></i>
								<span class="hotel-price hotel-color-orange">￥1500</span>
							</p>
							<p class="mui-ellipsis">
								高档酒店
								<i class="fa fa-gift"></i>
							</p>
							<p class="mui-ellipsis">
								公主坟，五棵松，石景山游乐园
								<span class="hotel-away">1公里</span>
							</p>
						</div>
					</li>
					<li class="mui-table-view-cell mui-media">
						<img src="img/room5.jpg" class="mui-media-object mui-pull-left hotel-img" />
						<div class="mui-media-body">
							北京钓鱼台国宾馆
							<p class="mui-ellipsis">
								<span class="hotel-rate hotel-color-blue">4.3分</span>
								<i class="fa fa-wifi"></i>
								<span class="hotel-price hotel-color-orange">￥1500</span>
							</p>
							<p class="mui-ellipsis">
								高档酒店
								<i class="fa fa-gift"></i>
							</p>
							<p class="mui-ellipsis">
								公主坟，五棵松，石景山游乐园
								<span class="hotel-away">1公里</span>
							</p>
						</div>
					</li>
					<li class="mui-table-view-cell mui-media">
						<img src="img/room5.jpg" class="mui-media-object mui-pull-left hotel-img" />
						<div class="mui-media-body">
							北京钓鱼台国宾馆
							<p class="mui-ellipsis">
								<span class="hotel-rate hotel-color-blue">4.3分</span>
								<i class="fa fa-wifi"></i>
								<span class="hotel-price hotel-color-orange">￥1500</span>
							</p>
							<p class="mui-ellipsis">
								高档酒店
								<i class="fa fa-gift"></i>
							</p>
							<p class="mui-ellipsis">
								公主坟，五棵松，石景山游乐园
								<span class="hotel-away">1公里</span>
							</p>
						</div>
					</li>
				</ul>
			</div>
		</div>
		<nav class="mui-bar mui-bar-tab">
			<a class="mui-tab-item mui-active">
				<span class="mui-icon mui-icon-home"></span>
				<span class="mui-tab-label">首页</span>
			</a>
			<a class="mui-tab-item">
				<span class="mui-icon mui-icon-chat"></span>
				<span class="mui-tab-label">联系</span>
			</a>
			<a class="mui-tab-item">
				<span class="mui-icon mui-icon-compose"></span>
				<span class="mui-tab-label">订单</span>
			</a>
			<a class="mui-tab-item">
				<span class="mui-icon mui-icon-person"></span>
				<span class="mui-tab-label">我的</span>
			</a>
		</nav>
	</body>
	<script src="js/mui.min.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		mui.init({
			pullRefresh: {
				container: "#refreshContainer", //下拉刷新容器标识，querySelector能定位的css选择器均可，比如：id、.class等
				down: {
					height: 50, //可选,默认50.触发下拉刷新拖动距离,
					auto: true, //可选,默认false.自动下拉刷新一次
					contentdown: "下拉可以刷新", //可选，在下拉可刷新状态时，下拉刷新控件上显示的标题内容
					contentover: "释放立即刷新", //可选，在释放可刷新状态时，下拉刷新控件上显示的标题内容
					contentrefresh: "正在刷新...", //可选，正在刷新状态时，下拉刷新控件上显示的标题内容
					callback: getData //必选，刷新函数，根据具体业务来编写，比如通过ajax从服务器获取新数据；
				}
			}
		});

		function getData() {
			ajax("get", "json/data.txt");
			mui('#refreshContainer').pullRefresh().endPulldownToRefresh();
		}

		function ajax(type, url) {
			
			//1.创建一个AJAX对象
			var xhr = new XMLHttpRequest;
			//2.打开一个url地址
			xhr.open(type, url, true);
			//3.监听数据请求
			xhr.onreadystatechange = function() {
					if(xhr.readyState === 4 && /^2\d{2}$/g.test(xhr.status)) {
						var jsonData = JSON.parse(xhr.responseText);
						var frag=document.createDocumentFragment();
						for(var i = 0; i < jsonData.length; i++) {
							var oLi = document.getElementById("refreshContainer").getElementsByTagName("li")[0].cloneNode(true);
							oLi.getElementsByClassName("hotel-img")[0].src = jsonData[i]["img"];
							oLi.getElementsByClassName("mui-media-body")[0].childNodes[0]["nodeValue"] = jsonData[i]["name"];
							oLi.getElementsByClassName("hotel-rate")[0].innerHTML = jsonData[i]["rate"];
							oLi.getElementsByClassName("hotel-price")[0].innerHTML = jsonData[i]["price"];
							oLi.getElementsByClassName("mui-ellipsis")[1].innerHTML = jsonData[i]["type"] + '<i class="fa fa-gift"></i>';
							oLi.getElementsByClassName("mui-ellipsis")[2].innerHTML = jsonData[i]["nearby"] + '<span class="hotel-away">' + jsonData[i]["away"] + '</span>';
							frag.appendChild(oLi);
						}
						mui(".mui-table-view")[0].insertBefore(frag, mui(".mui-table-view")[0].firstChild);
					    mui(".mui-table-view").on("tap",".mui-table-view-cell",function(){
					  		var name= this.getElementsByClassName("mui-media-body")[0].childNodes[0]["nodeValue"];
					  		var rate= this.getElementsByClassName("hotel-rate")[0].innerHTML;
					  		var type= /[\u4e00-\u9fa5]+/.exec(this.getElementsByClassName("mui-ellipsis")[1].innerHTML);
					  		var imgSrc = this.getElementsByClassName("hotel-img")[0].src
					  		var t=new Date();
					  		window.location.href="hotel-detail.html?name="+name+"&rate="+rate+"&type="+type+"&imgSrc="+imgSrc+"&t="+t.getTime();
					    })
					    
					}
				}
				//4.发送数据
			xhr.send(null);
			
		}
	</script>

</html>